<div class="main-toolbar">
  <div fxFlex fxLayout fxLayoutAlign="start">
    <mat-form-field class="calendar-picker">
      <input
        matInput
        [matDatepicker]="dp"
        (click)="dp.open()"
        [formControl]="date"
      />
      <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
      <mat-datepicker [touchUi]="isMobile" #dp></mat-datepicker>
    </mat-form-field>
  </div>
  <div fxFlex fxLayout fxLayoutAlign="end">
    <div class="search-form">
      <mat-form-field class="search-bar">
        <input type="search" matInput placeholder="Search Jobs" />
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
    </div>
  </div>
</div>
<div *ngFor="let day of days">
  <div class="weekday-display">
    <div fxFlex fxLayout fxLayoutGap="5px" fxLayoutAlign="start">
      <button mat-raised-button (click)="openDialog()">
        <mat-icon>
          add
        </mat-icon>
      </button>
      <button mat-raised-button fxHide.xs>
        <mat-icon>
          print
        </mat-icon>
      </button>
    </div>
    <div fxFlex fxLayout fxLayoutAlign="end" id="week">
      {{ day.date | date: 'fullDate' }}
    </div>
  </div>
  <div *ngFor="let slot of day.slots">
    <mat-card class="filled-mat-card" *ngIf="slot.job !== null; else emptySlot">
      <div class="card-container">
        <div class="row">
          <div class="col-sm-2" id="postcode-col">
            <mat-icon class="info-icon">explore</mat-icon>
            E16 3NP
          </div>
          <div class="col-sm-2" id="time-col">
            <mat-icon class="info-icon">access_time</mat-icon>
            {{ slot.job.timeFrom | date: 'shortTime' }} -
            {{ slot.job.timeTo | date: 'shortTime' }}
          </div>
          <div class="col-sm-2" id="contact-col">
            <mat-icon class="info-icon">person</mat-icon>
            Josh Homes
          </div>
          <div class="col-sm-2" id="phone-col">
            <mat-icon class="info-icon">local_phone</mat-icon>
            <a href="tel:{{ slot.job.private.phoneNumber }}">{{
              slot.job.private.phoneNumber
            }}</a>
          </div>
          <div class="col-sm-4" id="address-col">
            <mat-icon class="info-icon">home</mat-icon>
            {{ slot.job.address.addressLine1 }}
          </div>
          <div fxFlex fxLayout fxLayoutAlign="end" fxHide.xs>
            <button mat-button class="options-button">
              <mat-icon class="edit-icon">edit</mat-icon>
            </button>
            <button mat-button class="options-button">
              <mat-icon class="status-icon">brightness_1</mat-icon>
            </button>
            <button
              mat-button
              *ngIf="expanded[0]; else expandMore"
              class="options-button"
              (click)="onExpansion()"
            >
              <mat-icon class="expand-icon">expand_less</mat-icon>
            </button>
            <ng-template #expandMore>
              <button mat-button class="options-button" (click)="onExpansion()">
                <mat-icon class="expand-icon">expand_more</mat-icon>
              </button>
            </ng-template>
          </div>
          <div fxHide.gt-xs fxFlex fxLayout fxLayoutAlign="center">
            <button mat-button class="options-button">
              <mat-icon class="edit-icon">edit</mat-icon>
            </button>
            <button
              mat-button
              *ngIf="expanded[0]; else expandMore"
              class="options-button"
              (click)="onExpansion()"
            >
              <mat-icon class="expand-icon">expand_less</mat-icon>
            </button>
            <ng-template #expandMore>
              <button mat-button class="options-button" (click)="onExpansion()">
                <mat-icon class="expand-icon">expand_more</mat-icon>
              </button>
            </ng-template>
            <button mat-button class="options-button">
              <mat-icon class="status-icon">brightness_1</mat-icon>
            </button>
          </div>
        </div>
      </div>
      <mat-divider *ngIf="expanded[0]"></mat-divider>
      <mat-card-content>
        <div
          class="example-element-detail"
          [@detailExpand]="expanded[0] === true ? 'expanded' : 'collapsed'"
        >
          <div class="expansion-container">
            <div class="row">
              <div class="col-sm">
                Contact: Josh Holmes
              </div>
              <div class="col-sm">
                Address: 21 Hartington Road
              </div>
              <div class="col-sm">
                Phone: 07894875433
              </div>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
    <ng-template #filledSlot> </ng-template>
    <ng-template #emptySlot>
      <mat-card class="empty-mat-card">
        <div id="empty-slot-time">
          {{ slot.defaultFrom | date: 'shortTime' }} -
          {{ slot.defaultTo | date: 'shortTime' }}
        </div>
        <div fxHide.xs fxLayout="row" fxLayoutAlign="center center">
          <button mat-icon-button [disableRipple]="true">
            <mat-icon id="add-circle-icon">
              add
            </mat-icon>
          </button>
        </div>
        <div fxHide.gt-xs fxLayout="row" fxLayoutAlign="center center">
          <button mat-icon-button [disableRipple]="true">
            <mat-icon id="add-circle-icon">
              add
            </mat-icon>
          </button>
        </div>
      </mat-card>
    </ng-template>
  </div>
</div>
